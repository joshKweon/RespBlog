{"ast":null,"code":"import _objectSpread from\"/Users/sj2/gitDesk/RespBlog/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/sj2/gitDesk/RespBlog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from'react';import{useDispatch,useSelector}from\"react-redux\";import{Card,Form,Input,Typography,Button}from\"antd\";import FileBase64 from\"react-file-base64\";import styles from'./styles';import{createStory,updateStory}from'../../actions/stories';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Title=Typography.Title;function StoryForm(_ref){var _user$result;var selectedId=_ref.selectedId,setSelectedId=_ref.setSelectedId;var story=useSelector(function(state){return selectedId?state.stories.find(function(story){return story._id===selectedId;}):null;});var dispatch=useDispatch();var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var user=JSON.parse(localStorage.getItem(\"profile\"));var username=user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result.username;var onSubmit=function onSubmit(formValues){selectedId?dispatch(updateStory(selectedId,_objectSpread(_objectSpread({},formValues),{},{username:username}))):dispatch(createStory(_objectSpread(_objectSpread({},formValues),{},{username:username})));reset();};useEffect(function(){if(story){form.setFieldsValue(story);}},[story,form]);var reset=function reset(){form.resetFields();setSelectedId(null);};if(!user){return/*#__PURE__*/_jsx(Card,{style:styles.formCard,children:/*#__PURE__*/_jsxs(Title,{level:4,children:[/*#__PURE__*/_jsx(\"span\",{style:styles.formTitle,children:\"Welcome to Instaverse!\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),\"Please \",/*#__PURE__*/_jsx(Link,{to:\"/authform\",children:\"login\"}),\" or\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/authform\",children:\"register\"}),\"  for sharing instant moments or ideas.\"]})});}return/*#__PURE__*/_jsx(Card,{style:styles.formCard,title:/*#__PURE__*/_jsxs(Title,{level:4,style:styles.formTitle,children:[selectedId?\"Editing\":\"Share\",\" a story\"]}),children:/*#__PURE__*/_jsxs(Form,{form:form,labelCol:{span:6},wrapperCol:{span:16},layout:\"horizontal\",size:\"middle\",onFinish:onSubmit,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"caption\",label:\"Caption\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input.TextArea,{allowClear:true,autoSize:{minRows:2,maxRows:6}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"tags\",label:\"Tags\",children:/*#__PURE__*/_jsx(Input.TextArea,{allowClear:true,autoSize:{minRows:2,maxRows:6}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"image\",label:\"Image\",rules:[{required:true}],children:/*#__PURE__*/_jsx(FileBase64,{type:\"file\",multiple:false,onDone:function onDone(e){form.setFieldsValue({image:e.base64});}})}),/*#__PURE__*/_jsx(Form.Item,{wrapperCol:{span:16,offset:6},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",block:true,htmlType:\"submit\",children:\"Share\"})}),!selectedId?null:/*#__PURE__*/_jsx(Form.Item,{wrapperCol:{span:16,offset:6},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",block:true,htmlType:\"button\",danger:true,onClick:reset,children:\"Discard\"})})]})});}export default StoryForm;","map":{"version":3,"sources":["/Users/sj2/gitDesk/RespBlog/client/src/components/StoryForm/StoryForm.jsx"],"names":["React","useEffect","useDispatch","useSelector","Card","Form","Input","Typography","Button","FileBase64","styles","createStory","updateStory","Link","Title","StoryForm","selectedId","setSelectedId","story","state","stories","find","_id","dispatch","useForm","form","user","JSON","parse","localStorage","getItem","username","result","onSubmit","formValues","reset","setFieldsValue","resetFields","formCard","formTitle","span","required","minRows","maxRows","e","image","base64","offset"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Card, Form, Input, Typography, Button } from \"antd\";\nimport FileBase64 from \"react-file-base64\";\nimport styles from './styles';\nimport { createStory, updateStory } from '../../actions/stories';\nimport { Link } from 'react-router-dom';\n\nconst { Title } = Typography;\n\nfunction StoryForm({ selectedId, setSelectedId }) {\n\n  const story = useSelector((state) => selectedId ? state.stories.find(story => story._id === selectedId) : null);\n\n  const dispatch = useDispatch();\n  const [form] = Form.useForm();\n\n  const user = JSON.parse(localStorage.getItem(\"profile\"));\n  const username = user?.result?.username;\n\n  const onSubmit = (formValues) => {\n    selectedId ?\n    dispatch(updateStory(selectedId, { ...formValues, username }))\n    : dispatch(createStory({ ...formValues, username }));\n\n    reset();\n  };\n\n  useEffect(() => {\n    if(story) {\n      form.setFieldsValue(story);\n    }\n  }, [story, form]);\n\n  const reset = () => {\n    form.resetFields();\n    setSelectedId(null);\n  }\n\n  if (!user) {\n    return (\n      <Card style={styles.formCard}>\n        <Title level={4}>\n          <span style={styles.formTitle}>\n            Welcome to Instaverse!\n          </span> <br />\n          Please <Link to=\"/authform\">login</Link> or{\" \"}\n          <Link to=\"/authform\">register</Link>  for sharing instant moments or ideas.\n        </Title>\n      </Card>\n    );\n  }\n\n  return (\n    <Card\n      style={styles.formCard}\n      title={\n        <Title level={4} style={styles.formTitle}>\n          {selectedId ? \"Editing\" : \"Share\" } a story\n        </Title>\n      }\n    >\n      <Form\n        form={form}\n        labelCol={{ span: 6 }}\n        wrapperCol={{ span: 16 }}\n        layout=\"horizontal\"\n        size=\"middle\"\n        onFinish={onSubmit}\n      >\n        <Form.Item name=\"caption\" label=\"Caption\" rules={[{ required: true }]} >\n          <Input.TextArea allowClear autoSize={{ minRows: 2, maxRows: 6 }} />\n        </Form.Item>\n        <Form.Item name=\"tags\" label=\"Tags\" >\n          <Input.TextArea allowClear autoSize={{ minRows: 2, maxRows: 6 }}  />\n        </Form.Item>\n        <Form.Item name=\"image\" label=\"Image\" rules={[{ required: true }]}>\n          <FileBase64\n            type=\"file\"\n            multiple={false}\n            onDone={(e) => {\n              form.setFieldsValue({\n                image: e.base64\n              })\n            }}\n          />\n        </Form.Item>\n        <Form.Item\n          wrapperCol={{\n            span: 16,\n            offset: 6\n          }}\n        >\n         <Button\n          type=\"primary\"\n          block\n          htmlType='submit'\n         >\n           Share\n         </Button>\n        </Form.Item>\n        {!selectedId ? null :\n          <Form.Item\n            wrapperCol={{\n              span: 16,\n              offset: 6\n            }}\n          >\n          <Button\n            type=\"primary\"\n            block\n            htmlType='button'\n            danger\n            onClick={reset}\n          >\n            Discard\n          </Button>\n          </Form.Item>\n        }\n      </Form>\n\n    </Card>\n  )\n}\n\nexport default StoryForm"]},"metadata":{},"sourceType":"module"}